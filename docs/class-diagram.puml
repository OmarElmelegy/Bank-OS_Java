@startuml
!theme plain
skinparam classAttributeIconSize 0
skinparam linetype ortho
skinparam nodesep 60
skinparam ranksep 80
skinparam padding 8
skinparam backgroundColor White
skinparam shadowing false

' Visual styling
skinparam class {
    BackgroundColor White
    BorderColor #333333
    ArrowColor #666666
    FontSize 11
    BorderThickness 2
}

skinparam package {
    BorderColor #666666
    FontStyle bold
    BorderThickness 2
}

skinparam note {
    BackgroundColor #FFFACD
    BorderColor #DAA520
    FontSize 9
    BorderThickness 2
}

title Bank Account Management System\nClass Diagram

left to right direction

' ========================================
' DOMAIN MODEL - Account Hierarchy
' ========================================

package "banking.accounts" #E3F2FD {
    
    abstract class BankAccount {
        - accountNumber: String
        - owner: String
        - balance: double
        - status: AccountStatus
        # transactionLog: List<Transaction>
        --
        + BankAccount(String, String)
        --
        + deposit(double): void
        + withdraw(double): void
        + transferTo(BankAccount, double): void
        + applyInterest(): void
        --
        + freezeAccount(String): void
        + unfreezeAccount(String): void
        + closeAccount(String): void
        --
        # withdrawInternal(double, TransactionType): void
        # finalizeWithdrawal(double, TransactionType): void
    }
    
    note left of BankAccount
      <b>Template Method Pattern</b>
      
      Abstract base class providing
      common account operations.
      
      Subclasses customize withdrawal
      behavior via withdrawInternal().
    end note
    
    class CheckingAccount {
        - overdraftLimit: double
        - OVERDRAFT_FEE: double = 35.0
        --
        + CheckingAccount(String, String)
        + CheckingAccount(String, String, double)
        --
        + withdraw(double): void
        + getOverdraftLimit(): double
    }
    
    note right of CheckingAccount
      <b>Overdraft Support</b>
      • Default limit: $500
      • Fee: $35 per overdraft
      • Can withdraw beyond balance
    end note
    
    class SavingsAccount {
        - interestRate: double
        - DEFAULT_INTEREST_RATE: double = 0.02
        --
        + SavingsAccount(String, String)
        + SavingsAccount(String, String, double)
        --
        + withdraw(double): void
        + getInterestRate(): double
    }
    
    note right of SavingsAccount
      <b>Interest Bearing Account</b>
      • No overdraft allowed
      • Default rate: 2% annually
      • Customizable interest rate
    end note
    
    class User {
        - username: String
        - password: String
        - linkedAccountId: String
        --
        + User(String, String, String)
        --
        + getUsername(): String
        + getPassword(): String
        + getLinkedAccountId(): String
    }
    
    note left of User
      <b>Authentication Model</b>
      
      Links user credentials
      to bank account.
    end note
    
    enum AccountStatus {
        ACTIVE
        FROZEN
        CLOSED
    }
    
    BankAccount <|-- CheckingAccount
    BankAccount <|-- SavingsAccount
    BankAccount --> AccountStatus
    User --> BankAccount : links to
}

' ========================================
' TRANSACTIONS & AUDIT
' ========================================

package "banking.transactions" #FFF3E0 {
    
    class Transaction {
        - amount: double
        - type: TransactionType
        - timestamp: LocalDateTime
        --
        + Transaction(double, TransactionType)
        --
        + getAmount(): double
        + getType(): TransactionType
        + getTimestamp(): LocalDateTime
    }
    
    note bottom of Transaction
      <b>Immutable Audit Log</b>
      
      Thread-safe record of
      all account activities.
    end note
    
    enum TransactionType {
        DEPOSIT
        WITHDRAWAL
        TRANSFER
        FEE
        INTEREST
        REVERSAL
    }
    
    Transaction --> TransactionType
}

BankAccount "1" o-- "many" Transaction

' ========================================
' EXCEPTIONS
' ========================================

package "banking.exceptions" #FFEBEE {
    
    class InvalidAmountException
    class InsufficientFundsException
    class AccountStatusException
    class UserStatusException
    class InvalidCredentialsException
}

' ========================================
' BANKING SERVICES
' ========================================

package "banking" #E8F5E9 {
    
    class Bank {
        - accounts: ConcurrentHashMap
        - users: ConcurrentHashMap
        - scheduler: ScheduledExecutorService
        --
        + openAccount(BankAccount): void
        + getAccount(String): BankAccount
        --
        + createNewCustomer(...): void
        + authenticateUser(String, String): User
        --
        + payGlobalInterest(): void
        + startInterestService(): void
        + stopServices(): void
        --
        + saveData(): void
        + loadData(): void
    }
    
    note right of Bank
      <b>Central Registry</b>
      
      • Thread-safe collections
      • Scheduled interest payments
      • Data persistence
      • User management
    end note
    
    class CentralBank <<Singleton>> {
        - {static} instance: CentralBank
        - interestRate: double
        --
        - CentralBank()
        --
        + {static} getInstance(): CentralBank
        + getInterestRate(): double
        + setInterestRate(double): void
    }
    
    note right of CentralBank
      <b>Singleton</b>
      
      Global interest
      rate manager.
    end note
    
    Bank "1" *-- "many" BankAccount : manages
    Bank "1" *-- "many" User : registers
    BankAccount ..> CentralBank : uses
}

' ========================================
' APPLICATION LAYER
' ========================================

package "app" #F3E5F5 {
    class BankApp <<Main>> {
        + {static} main(String[]): void
    }
}

BankApp ..> Bank : uses

' ========================================
' EXCEPTION DEPENDENCIES
' ========================================

BankAccount ..> InvalidAmountException : throws
BankAccount ..> InsufficientFundsException : throws
BankAccount ..> AccountStatusException : throws
Bank ..> UserStatusException : throws
Bank ..> InvalidCredentialsException : throws

@enduml
